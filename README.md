# Yandex-ML-with-teacher
_Цель проекта:_

Разработать решение, которое позволит персонализировать предложения постоянным клиентам, чтобы увеличить их покупательскую активность.

_Задачи:_
1. Нужно промаркировать уровень финансовой активности постоянных покупателей. В компании принято выделять два уровня активности: «снизилась», если клиент стал покупать меньше товаров, и «прежний уровень».
2. Нужно собрать данные по клиентам по следующим группам:
    - Признаки, которые описывают коммуникацию сотрудников компании с клиентом.
    - Признаки, которые описывают продуктовое поведение покупателя. Например, какие товары покупает и как часто.
    - Признаки, которые описывают покупательское поведение клиента. Например, сколько тратил в магазине.
    - Признаки, которые описывают поведение покупателя на сайте. Например, как много страниц просматривает и сколько времени проводит на сайте.

Представим группы признаков (вместе с целевым) в виде диаграммы — такую визуализацию ещё называют диаграммой Исикавы.

![На диаграмме входные признаки объединены в четыре группы: коммуникация с клиентом, продуктовое поведение, поведение на сайте и финансовое поведение.](https://pictures.s3.yandex.net:443/resources/image_1695485033.png)

1. Нужно построить модель, которая предскажет вероятность снижения покупательской активности клиента в следующие три месяца.
2. В исследование нужно включить дополнительные данные финансового департамента о прибыльности клиента: какой доход каждый покупатель приносил компании за последние три месяца.
3. Используя данные модели и данные о прибыльности клиентов, нужно выделить сегменты покупателей и разработать для них персонализированные предложения.


_Ниже будет предствлен план выполнения проекта:_


__1.1__ Загрузить данные. Файлы `market_file.csv`, `market_money.csv`, `market_time.csv`, `money.csv` доступны по ссылкам в описании данных или через пути к ним:
- `/datasets/market_file.csv`
- `/datasets/market_money.csv`
- `/datasets/market_time.csv`
- `/datasets/money.csv`

__1.2__ Проверить, что данные в таблицах соответствуют описанию. Исследованием и объединением данных вы займётесь позже.

__2.1__ Проведисти необходимую предобработку данных. Названия столбцов можно оставить кириллическими.


__3.1__ Проведисти исследовательский анализ данных из каждой таблицы. Отберать клиентов с покупательской активностью не менее трёх месяцев, то есть таких, которые что-либо покупали в этот период. Оформить выводы по результатам шага.

__4.1__ Объединить таблицы `market_file.csv`, `market_money.csv`, `market_time.csv`. Данные о прибыли из файла `money.csv` при моделировании не понадобятся.

__4.2__ Учесть, что данные о выручке и времени на сайте находятся в одном столбце для всех периодов. В итоговой таблице сделайте отдельный столбец для каждого периода.

__5.1__ Проведсти корреляционный анализ признаков в количественной шкале в итоговой таблице для моделирования. Сделать выводы о мультиколлинеарности и при необходимости устраните её.



__Примените все изученные модели. Для этого использовать пайплайны.__


__6.1__ Во время подготовки данных использовать `ColumnTransformer`. Количественные и категориальные признаки обработайте в пайплайне раздельно. Для кодирования категориальных признаков используйте как минимум два кодировщика, для масштабирования количественных — как минимум два скейлера.


__6.2__ Обучить четыре модели: `KNeighborsClassifier()`, `DecisionTreeClassifier()`, `LogisticRegression()` и `SVC()`. Для каждой из них подобрать как минимум один гиперпараметр. Выбрать подходящую для задачи метрику, аргументировать свой выбор. Использовать эту метрику при подборе гиперпараметров.

__6.3__ Выбрать лучшую модель, используя заданную метрику. Для этого примените одну из стратегий:

- использовать пайплайны и инструменты подбора гиперпараметров для каждой модели отдельно, чтобы выбрать лучшую модель самостоятельно;
- использовать один общий пайплайн для всех моделей и инструмент подбора гиперпараметров, который вернёт вам лучшую модель.



__7.1__ Оценить важность признаков для лучшей модели и построить график важности с помощью метода SHAP.

__7.2__ Сделайть выводы о значимости признаков:

- какие признаки мало значимы для модели;
- какие признаки сильнее всего влияют на целевой признак;
- как можно использовать эти наблюдения при моделировании и принятии бизнес-решений.



__8.1__ Выполнить сегментацию покупателей. Используйте результаты моделирования и данные о прибыльности покупателей.

__8.2__ Выберать группу покупателей и предложить, как увеличить её покупательскую активность:

- Проведисти графическое и аналитическое исследование группы покупателей.
- Сделайть предложения по работе с сегментом для увеличения покупательской активности.

__8.3__ Сделайть выводы о сегментах:

- какой сегмент вы взяли для дополнительного исследования,
- какие предложения вы сделали и почему.



__9.1__ Сделайть общий вывод:

- описать задачу;
- описать исходные данные и проведённую предобработку;
- написать, что вы сделали для поиска лучшей модели;
- указать лучшую модель;
- добавить выводы и дополнительные предложения для выбранного сегмента покупателей.



__Данные:__

[`market_file.csv`](https://code.s3.yandex.net/datasets/market_file.csv)

Таблица, которая содержит данные о поведении покупателя на сайте, о коммуникациях с покупателем и его продуктовом поведении.

- `id` — номер покупателя в корпоративной базе данных.
- `Покупательская активность` — рассчитанный класс покупательской активности (целевой признак): «снизилась» или «прежний уровень».
- `Тип сервиса` — уровень сервиса, например «премиум» и «стандарт».
- `Разрешить сообщать` — информация о том, можно ли присылать покупателю дополнительные предложения о товаре. Согласие на это даёт покупатель.
- `Маркет_актив_6_мес` — среднемесячное значение маркетинговых коммуникаций компании, которое приходилось на покупателя за последние 6 месяцев. Это значение показывает, какое число рассылок, звонков, показов рекламы и прочего приходилось на клиента.
- `Маркет_актив_тек_мес` — количество маркетинговых коммуникаций в текущем месяце.
- `Длительность` — значение, которое показывает, сколько дней прошло с момента регистрации покупателя на сайте.
- `Акционные_покупки` — среднемесячная доля покупок по акции от общего числа покупок за последние 6 месяцев.
- `Популярная_категория` — самая популярная категория товаров у покупателя за последние 6 месяцев.
- `Средний_просмотр_категорий_за_визит` — показывает, сколько в среднем категорий покупатель просмотрел за визит в течение последнего месяца.
- `Неоплаченные_продукты_штук_квартал` — общее число неоплаченных товаров в корзине за последние 3 месяца.
- `Ошибка_сервиса` — число сбоев, которые коснулись покупателя во время посещения сайта.
- `Страниц_за_визит` — среднее количество страниц, которые просмотрел покупатель за один визит на сайт за последние 3 месяца.

[`market_money.csv`](https://code.s3.yandex.net/datasets/market_money.csv)

Таблица с данными о выручке, которую получает магазин с покупателя, то есть сколько покупатель всего потратил за период взаимодействия с сайтом.

- `id` — номер покупателя в корпоративной базе данных.
- `Период` — название периода, во время которого зафиксирована выручка. Например, `'текущий_месяц'` или `'предыдущий_месяц'`.
    
- `Выручка` — сумма выручки за период.
    

[`market_time.csv`](https://code.s3.yandex.net/datasets/market_time.csv)

Таблица с данными о времени (в минутах), которое покупатель провёл на сайте в течение периода.

- `id` — номер покупателя в корпоративной базе данных.
- `Период` — название периода, во время которого зафиксировано общее время.
- `минут` — значение времени, проведённого на сайте, в минутах.

[`money.csv`](https://code.s3.yandex.net/datasets/money.csv)

Таблица с данными о среднемесячной прибыли покупателя за последние 3 месяца: какую прибыль получает магазин от продаж каждому покупателю.

- `id` — номер покупателя в корпоративной базе данных.
- `Прибыль` — значение прибыли.